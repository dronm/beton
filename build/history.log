1.009 16/04
1) Калькулятор звонка
2) Запявка из звонка
3) Штрихкод в журнале отгрузок (гашение бланков)
4) Косяки в VariantStorageBeton.php

1.010 16/04
1) Убрал график при открытии с мобильного телефона

1.011 18/04
1) Нет информации по насосу в таблице заявок
2) Нет в списке насосов хозяина авто
3) Не выскакивает сообщение callAgent при неподнятой трубке
4) Стоимость бетона отдельно
5) Полностью переделал обсчет цен/стоимостей в заявке
6) Убрал шрифт, поставил по-умолчанию!
7) Отгрузки в заявке: подправил ширину колонок
8) Отгрузки в заявке: убрал моргание при редактировании


1.012 22/04
1) Сокращенное наименование объекта в таблице назначений главного экрана
2) Учет расстояние при расчете доставки
3) Отгрузки в заявках зеленые, если отгружены

1.014 25/04
1) Поля количество и разгрузка уменьшил по длине


1.015 25/04
1) Список отгрузок у заявки: итог был не под колонкой "количество"
2) Таблица диспетчера: добавлен завод
3) Таблица диспетчера: убрана раскарска через одну, таблица сужена


1.016 26/04
1) Список прорабов контрагента!!!
2) Изменение пароля пользователя, отправить новый пароль по СМС
3) Сильно бледные отгруженные заявки
4) Шрифт не тот, надо как в старой
5) Цвет гиперссылок ярче (телефон, меню)
6) Дробное кол-во не ставит точку
7) Назначение авто добавить раскраску как в статусах! Назначение авто из заявки
8) Формирование графиков: возможность нескольких авто!!!
9) Формирование графиков: добавить водителя, менять водитяля в параметрах авто, если поменяли

1.017 29/04
1) Когда назначаем водителей, они идут сверху вниз - очередность, а когда смотрим на завод 1,
там список наоборот снизу вверх по водителям, нужно чтобы они были также сверху вниз.
assigned_vehicles_list  поставил ASC?
2) в заявках и в окне звонка, марку, вид насоса и насос сделать меньше
3) Язык убрал полностью
4) Обновление списка заявок сразу после изменения заявки
5) Наименование насоса в гл.таблице
6) Назначения на главном экране: сначала Авто+Водитель сокращенный
7) Пользователи: доступ закрыт отобразить в списке
8) Насосы: возможность пометить не работающие
9) СМС по насосам теперь правильно
10) Поле всего шире
11) Записать клиента в звонках


1.018 30/04
1) Табель рабочего времени EmployeeWorkTimeSchedule
2) Разрешенные повторы ClientValidDuplicate_Controller->get_list
3) Отчет лаборанта LabEntry_Controller->lab_report
4) Таблица оператора: кто отгрузил, раскраска колонок

1.019 01/05
1) Ввод в отгрузки баллов и простоя
2) Журнал песок
3) Журнал щебень
4) Отчет по звонкам AstCall_Controller->manager_report
5) Показатели по месяцам LabEntry_Controller->item_report
6) Показатели по периодам LabEntry_Controller->item_on_rate_period_report
7) Средние показатели по датам LabEntry_Controller->lab_avg_report
8) График всегда от 0
9) Список констант
10) Прайс по бетону по датам
11) Прайс по доставке по датам
12) Прайс по доставке (водители) по датам


1.020 02/05
1) Специальная цена для некоторых объектов по доставке


1.021 от 06/05
1) Цена доставки и бетона из старого прайса (форма диалога)
2)!!! НЕПРАВИЛЬНО отображает прошлый день, время текущее!!!, например 28/04
3) Не сохранялось редактирование суммы
4) В звонках если первый раз - просто номер и тип клиента

1.022 от 07/05
1) Звук при назначении
2) Кол-во в отгрузках оператора 1 знак

1.023 13/05
1) Кто последний менял заявку
2) ИНН клиента
3) При погашении отгрузок сканером - сообщение внизу экрана
4) Сортировка по бланкам в отгрузках
5) Поле согласовая отгрузок владельцем

1.026 13/05
1) Коммент в насосах
2) Убрал косяки с валдельцем


1.027 14/05
1) Журнал отгрузок стоимость насосов
2) Звонки при изменении контрагента все контакты переписываются на него!
3) Назначение: звук только при большом экране
4) Косяк в списке владельцев

1.028 16/05
1) Владельцы: добавлена связка с клиентом
2) Звонки: изменение клиента переносит все контакты на нового
3) ШК исправлен косяк


1.029 20/05
1) Старый владелец в списке назначений
2) Форма оператора: убрать буквы авто
3) Желтый а не фиолетовый когда сейча фиолетовый
4) Сокр форма назначений, сократть ФИО, авто!!! не влазит!!! Авто(цифры)+ФИО сокращенное
5) Возможность удалять отгрузки при назначенной, а если отгружена - запросить комментарий, занести в доп.таблицу - Справочники отмененные отгрузки
6) Слетает фильтр звонков

1.030 22/05
1) Согласование владельцем миксер и насос раздельно
2) Сумма насос вручную для бухгалтерии
3) Список текущих заявок под насос
4) Отгрузки насосы с согласованием


1.031 28/05
1) Изменить расчет простоя->  перевод в доли и округление до десятых 01:20 = 1,33=1,3х700=910
2) Корявый ввод простоя - не вводится, не очищается
3) Не понятно приходят журналы: отгрузки, сначала время до 06:59, а потом меняется!!! VariantStorageBeton
4) Экспорт в Excel пока нет автообновления не использует предопределенный фильтр
5) Насосы в ЛК привел в соответствие
6) Стоимость доставки, насоса все отдельными функциями единый расчет из shipments_list,shipments_dialog,shipments_pump_list
7) Редактирование доставки в диалоге, изменение суммы
8) Заявки под насос: привести в соответствие колонки, только не исполненные
9) Таблица доставок привести в соответствие
10) При звонке, создание заявки объеденить с "Изменить"
11) Стоимость насоса
12) Колонки у ЛК владельца, отгрузки


1.031 29/05
1) Привел в соответствие таблицу отгрузок, убрал неточности при выгрузке в ексель
2) Стоимость насоса исправлена


1.032 08/06
1) Стоимость доставки когда отредактирована - отображается в журнале
2) Косяк в форме диалога доставки при установленном редактировании
3) Список отгрузок для владельца ТС: отдельный список! из-за экспорта в Ексель


1.035 10/06
1) Пишет pump_cost_edit когда изменяется ship_cost_edit

1.036 14/06
1) Форма опрератора: итоги общие а не по заводам
2) Форма опрератора: итог по количеству, выравнивание
3) ЛК закачика - метод не доступен
4) ЛК заказчика, отгрузки, сумма для водителя
5) Проверить расчет доставки, смотрит ли он прайс на дату??? или ролсто последний

1.037 17/06
1) ShipmentList_View findDoc ошибка при выводе сообщения об успешном считывании
2) UserOperatorList для смены завода диспетчерами у операторов. Также возможность динамической замены завода у оператора
3) Информация по заводам в форме оператора
4) Форма по отгрузкам по клиенту-владельцу ТС


1.038 19/06
1) Запрос order_pumps_list_view неправильно отображал из-за отсутствия coalesce
2) Обновление завода диспетчерами, новый метод из-за безопасности, User->update_production_site()


1.039 20/06
1) Прайс бетон для владельцев ТС
2) Форма по текущим назначениям: автообновление
3) Отгрузки по клиентам для владельца - передалел полностью

1.040 22/06
1) Клиенту владельцев теперь свзяь один ко многим
2) Прайсы по бетону для владельцев теперь есть история прайсов
3) Стоимость чужего насоса для клиентов-владельцев

1.041 24/06
1) Согласование насоса также как отгрузка по датам
2) Отчет по итогам для владельца
3) Итоги по всй выборке а не по страницам (отгрузки, владельцы насосы,владельцы клиенты)


1.042 26/06
1) Не обновляет форму текущий назначений
2) Косяк, не отркывает форму владельцев


1.043 27/06
1) Коммент бухгалтера в отгрузке, отдельный для миксера, который есть - для насоса. Вывод для ЛК владельца
2) Отгрузки для владельца - коммент для отгрузок
3) NaN  в итогах для владельца
4) Новая колонка в итогах: простой, чужой насосы
5) марки бетона не открывает
6) Отчет по итогам неправильно берет период, не по сменам!!! конечная дата не верно!

1.044 28/06
1) Прайс на бетон для владельца брать не из отдельной колонки а у клиента владельца shipments_for_client_veh_owner_list
2) Мобильная версия: звонок с экрана, форма заявок
3) Форма владельца отгрузки по объектам:Итоги, смена периода не работала


1.045 29/06
1) Форма для владельца "Самовывоз", нет фильтра по клиентам владельца
2) Проблема с датой по в журнале с отбором по сменам
3) Мотоды сохранения/восстановления настроек длЯ владельца


1.046 03/07
1) Форма для моб.телефона, насос отдельно в колонку!
2) Новое окно стоимость насоса для клиента, редактирование, в форму Самовывоз для владельцев стоимость чужего насоса


1.047 04/07
1) Мобильная версия косяк, ошибка по пред.дню!!!
2) При назначении запрет ставить 0!
3) Период при выборе предыдущая смена дата по встает на 2 суток вперед!
4) Невозможно редактировать прайсы по бетону для владельцев - обновление таблицы мешает+ ошибка old_client_id
5) Автообновление при детальной таблице убрал



1.048 06/07
1) Выбрано бетона|Доставка|Чужой насоса|+++Простой+++|
2) Самовывоз добавить колонку клиент у кого несколько клиентов
3) Ошибка в поиске по объекту,клиенту (наименование)

1.049 09/07
1)Подключить автосогласование regl_auto_accord
2) Отметка всех у владельца ТС одним кликом
3) Крупная форма назначений + последние отгрузки


1.050 12/07
1) Регламентные задания: неработающие трекеры,состояние надо подключтьб от новой!!!
2) Расход материалов рассшифровка
3) Общая таблица
4) Корректировка расхода
5) Завка в клиенте, в таблице имя+инн, при поборе имя+ИНН


1.052 07/08
1) При маленьком разрешении никаких звонков!
2) Косяк с обновлением мастер таблицы с деталями: не уничтожалась детальная таблица из-за чего увеличивалась нагрузка на сервер


1.053,1.054 30/09/19 for testing on server
1) shipment_process() При изменении экипажа, старые данные не удаляются, так и остается назначенным
2) Несколько телефонов у насоса. СМС отправлять по всем возможным
update pump_vehicles
set phone_cels = ('{"id": "TelList_Model", "rows": [{"fields": {"id": 1, "tel": "'||phone_cel||'"}}]}')::jsonb
WHERE phone_cel IS NOT NULL

1.055 22/10/19
1) Загрузка данных с заводов
2) Журнла испытания образцов
3) Звуковой сигнао при изменении формы оператора
4) Вставка телефона в строку с шаблоном
5) Звонок водителю
6) Нормы расхода не открывает подборы
7) Цена для водителя по объекту "самовывоз" = 0 shipments_for_veh_owner_list
8) Поле цена для водителя в объекте, при установке будет браться именно она shipments_for_veh_owner_list
9) Звонок водителю из списка автомобилей

1.057 22/10/19
1) Опечатка в OrderMakeGrid нет кнопки  добавить заявку под owner

1.058 23/10/19
1) Пересчет подборов не работала, не был обновлен файл RawMaterialConsRateDate_Controller
2) OrderMakeGrid.js диспетчер не влючен в список для редактирования заявок
3) Проблемы со звонками, не всплывают, авторизация
4) Интерфейс Лаборанта не работает


1.059 23/10/19
1) Список экиражей при нажатии на колонку с водитедем не позиционирует. При освобождении добавлен вопрос. При Снятии со смены добавлена фамилия.
2) Общая таблица: выделение тек.колонки для редактирования

1.060 23/10/19
1) Лаборанту включить редактирование 
2) Лаборанту добавить список материалов

1.061 06/11/19
1) Меню загрузка файла с завода не открывает, а через Все функции открывает только в новом окне
2) Лаборанту не дает поменять период заявок
3) VehicleDialog_View грузоподъемность - дробное значение
4) shipments_listб shipments_for_veh_owner_list  исправлено поднескольких владельцев
5) Программа по взвешиванию, авторизация


1.062 11/11/19
1) Вместимость силоса не ставит в форме
2) Провеирть в Эксплорере в 11 работает нормально! Edge?
3) Косяк в отправках СМС насосникам
4) Ценовая схема насоса с датами, как прайсы
ПЕРЕНОС_ОДИН_КО_МНОГИМ запустить заново перенос цен насосов, Закомитить shipments_list
5)Добить программу взвешивания: авторизация

1.063,1.064 02/11/19
1) Насос: меняем на другой, новому приходят 2 СМС: добавлена, снята, при удалении насоса (нового нет), тоже самое
2) при расчете из звонка не ставит сумму
3) ShipmentForOrderList имеет ограничение на 60 строк, а пагинации нет!!!


1.065 20/04/20
1) Косяк во владельцах насосов, в списке насосов оставался владелец по старому: из параметров авто, а надо из нового JSONB поля
orders_make_list.sql,pump_veh_list,pump_veh_work_list

2) Добавл глобальный фильтр vehicle_owner_list, списки vehicle_dialog и насосы теперь фильтруются по вхоэждению
Добавил в vehicles Int Array поле vehicle_owners_ar для отбора по владельцам при входе в программу

3) Если нажали "запрет захода" - убить сессию данного пользователя!!!


4) Сделать чтобы можно было менять заявку у отгрузки, возможно с заменой объекта в 
update vehicle_schedule_states set destination_id=1225 where shipment_id=97949 and destination_id=1008


1.066 20/04/20
1) Ошибка при открытии звонка ViewObjectAjx.addDetailDataSet()
dsParams.control.getInsertPublicMethod()


1.069 27/04/20 
1) MaterialMakeOrderGrid фактический остаток
2) OperatorList_View параметры бляма
3) Свернутая таблица
4) Остатки материалов
Промежуточный слив


1.070 19/05/20
1) Shipment_Controller->update перекрытие метода для отправки СМС при смене заявки

1.071
1) Итоговая таблица (свернуто), тепреь с учетом корректировки. Итоги правильные.
2) Загрузка материалов из elkon теперь с учетом дат.


1.072
raw_material_cons_rates_on_date_id ПОМЕНЯТЬ ORDER BY id->ORDER BY ord Должно коррелировать с RawMaterialConsRate_Controller->get_list()


1.00176 10/06/20

1.00178 11/06/20


1.00179 21/07/20
1) При редактировании под lab_worker если изменена сумма, то она сбрасывается в дефолт
EditMoneyEditable.js добавлен парамтер toggleAllowed
OrderDialog_View отключена запись не нужных полей
2) Минимальное количество кубов для доставки берется из колнстанты min_quant_for_ship_cost
OrderCalc_View.js

3) Переделал текст СМС при отгрузке, жалуются что 

4) EditPeriodShift теперь правильно шагает по периодам, открывает предопределенные периоды
5) Изменил DateHelper.strtotime() тепаерь работает правильно в Safari



1.00180
1) Еще раз изменил DateHelper.strtotime()
2) Запись новой марки в прайс - ошибка, не задана дата. Поле уже не нужно
3) Форма диалога материала, при записи ошибка элемент не связан. Ошибка закралась в RawMaterialDialog_View
4) Корректировка фактического расхода материалов добавить итог по колонке количество5)
5) Отчет Фактический расход материалов на м3:
	- новая таблица Обнуления материалов
	- Разделитель разрадов в деньгах RepMaterialAvgConsumptionOnCtp.html.xsl
	- добавлены ручные корректировки material_avg_consumption_on_ctp.sql


1.00181 12/08/20
1) Еще раз изменил DateHelper.strtotime()
2) Список марок, цена из последней цены прайса и не редактируется!!! concrete_types_list.sql для чтения цен из последнего парйса для всех!!!
3) Экспорт локальных списков в Excel


1.00182
1) Добил форматирование для экспорта в Excel
2) Остатки материалов MatTotals_Model переделать остаток на вечер mat_totals.sql
3) Обнуление остатков силосов CementSiloBalanceResetList_View, cement_silo_balance_resets_list показывает отрицательное и красным
4) Отчет отклонение от фактического расхода мат-ов неправильно сворачивал при производстве из нескольких силосов
	Новая функция material_cons_tolerance_violation_list вместо представления
5) Функция удаления в приходах DOCMaterialProcurementList_View.js
6) Порядок следования материалов в DOCMaterialProcurement_Controller->get_shift_list
7) Расшифровка прихода. Фильтрация, итог DOCMaterialProcurementList_View


1.00183 04/09/20
1) Для оператора при переходе с силоса на силос дать возможность добавлять строки!!! Выбрать материал, кол-во и т.д.

1.00185 07/09/20
1) Убрал все косяки


1.00186 24/09/20
1) Добавление новых материалов оператором: теперь не просто добавляет в material_fact_consumptions, а добавляет в material_fact_consumptions
с кол-ом 0 + корректировка, тогда все верно работает
2) Расход материала (свернуто) в Excel - через новую Grid комманду для локального набора
3) Продолжали отправляться старые запросыв Дочерних окнах с ошибкой Neither parent nor node found! справил как в Экспертизе ViewBase.xsl.html


X расход на куб, вторая таблица стоиомость куба, остались точки, (факт)



1.00187
1) Таблица для клиентов ShipmentForClientList теперь доступна и для работников. Добавлено поле clients_ref в модель
2) RepMaterialAction
3) Форма для просмотра трэкеров, подстановка в авто
4) Учет добавки от нескольких заводов. Отобразить под заводами, в общей таблице пусть останется, ввод обнуления отдельно,
Доделать обнуление


1.00188
1) Надо наработка миксеров для всех, отбор по владельцу ТУПИТ почему то
Разобрался с сохранением настроек, настройки по-умолчанию
2) Косяк с меню

1.00189 27/10
1) Таблица Отгрузки по клиенту-владельцу ТС get_list_for_client_veh_owner&t=ShipmentForClientVehOwnerList
+Предопределенный фильтр месяц
+Поиск по объектам а не по строкам (у нас)
2) Таблица Отгрузки для владельцев ТС get_list_for_veh_owner&t=ShipmentForVehOwnerList
+Владельца в начало!
+Поиск по объектам а не по строкам (у нас)
3) Ошибка у лаборанта
4) При удалении пользователя - убить все его сессии
5) Отчет по водителям журнал открывает весь, хотя показывает месяц в офисе!	
6) Отчет по движению материалов по заводам


1.00190 28/10/20
1) Уменьшить размер бункеров добавки
2) Лаборант отбор по ОК
3) Нормы подбора + колонка номер подбора
4) Журнал испытания + колонка подбор из норм подбора, ссылка. При выборе ставить числовое значение
LabEntryList - остановился


1.00192
1) Отбор в журнале образцов: при выключенном отболре показывать все
2) Журнал образцов, ссылочное поле Подбор, ПОМЕНЯТЬ ModelSQL.php!!! на сервере!
3) Корректировка остатков материалов, с учетом завода, где дележка!!!
4) Размер бункеров с добавкой уменьшил
5) Бункеры с добавкой лаборанту


1.00193 03/11/20
1) Силосы когда=0 показывает графический остаток - исправлено
2) Привязка пр-ва по авто, был косяк в production_vehicle_corrections
3) mat_totals.sql исправлено, mat_virtual_consumption (брались не отгруженные назначения)
4) Очистки пропусков производств при поступлении выполнении одного из пропусков

1.00194 03/11/20
1) ViewObjectAjx.prototype.setDetailKey косяк в пагенации

-1) Пропущенные прозв-ва, удалить которых точно не будет!


1.00195
Не забыть обновить платформу db_con!!! проверить константу detailedError

1.00199
1) Шаблон телефона


1.00200

1.00201 15/03/21
+ Накосячил с расчетом доставки, DestinationForOrderEdit при перекрытии метода onSelect забыл передать в ориг.метод параметр fields
- Звонки убил из ViewBase
- Неверный формат номер со звонка



1.00208
1) Не сохраняет зону при создании, перерисовывеет завод!
2) Печать накладной, нет остатка когда не отгружен!
3) Не генерит расписание - исправил, сломалось из-за изменения хранения JSON field->ID
5) Косяк в форме диалога Клиента не отображал окуда, поля SELECT не верная связка
4) Не сохраняет данные со звонка - проверил, ошибки не нашел!


1.00210
MPA для лаболратории 2 знака

1.00211
1) форма лаборанта: события
2) прокладка маршрута
3) Загрузка расхода нового завода

1.00214 28/04
1) VehicleRoute если авто съехало с зоны, а на базе нет дольше обычного - не строить маршрут, значит съехал и не вернулся!
2) AppSrv - более не ругается если версия на сервере < версии браузера, только если наоборот!
3) Начал телефонию под ДОМРу
4) DestinationDialog пока не сдвинули зону не прокладывает маршрут
5) VehicleRoute при ощибке построения маршрута из предыдущего строит как обычно
6) AstCall_Controller стр.403,405 undefined index
7) Телефония ДомРу!

1.00215
1) route маркер а не зона
2) Сгладить маршрут
3) Отправка событий - Postgres!
4) Якобы при изменении заявки с насосом уходи СМС как на новую
5) AstCall при смене клиента, меняем на навого клиента только ЭТОТ контакт, а не ВСЕХ!!!
6) Вид насоса в заявке сделал async=FALSE, иначе проблема с расчетом цены
7) ссылка на маршрут для клиента
8) Кому не надо (клиенты) СМС не отправлять!

1.00216
1) Запись разговора вывел в ГУИ
2) Слишком длинный маршрут событие не проходит (остаток маршрута через postgres) таблица route_rests Map_View.js,rebuild_route.php,route/route.js
3) Загрузка расхода конкрид


1.00217
1) Проверить работу длинных маршрутов
2) doc_brutto, doc_netto поля при поступлении
3) Поле Vehicle->ord_num int
4) DOCMaterialProcurementList_View неверное отображение времени, вместо минут секунды!


1) ShipmentForClientList_View.js форма для сотрудников отличается от внешних: фильтры, экспорт и т.д.
2) Vehicle->get_total_shipped новый метод для статистики - публичный!
3) RawMaterial_Controller BEGIN, COMMIT при добавлении обновления загрузки
4) При изменении заявки в кол=0, отправлять СМС снята заявки, при удалении тоже. Насосникам тоже самое
5) Destination_Controller добавлена провека isset
6) Миксеристам не отправлять повторные СМС на тот же объект за тот же день

1) Галочка в заявке: не ставить в Элкон

1.00218 08/07
1)Цвета в силосах


1.00219
1) MaterialFactConsumption_Controller корректировка факт расхода: в запросах номер производства как %d, теперь строка!
2) Журнал расходов, двойное производство показывает дважды из-за джоина производств для показа количества, марка
Поменять shipments_list.sql при нерабочей базе!

1.00220
1) MaterialStoreForOrderList_View.js Если нет материалов, разделяемых по заводам, выводит пустой контрол, это не правильно,

добавил проверку на material_id - если пусто, строка пропускается, т.о. в Конкреде контрол вывода материала по заводу пропал
2) Отчет по движению материалов (RepMaterialAction), поменять +/- излишки-перерасход RepMaterialAction.html.xsl

3) Логотипы
ViewBase.html.xsl поменял itle на Берег
logo.png
favicon.ico(16x16)

4) Погода, возможность настройки города.
Weather_Controller_php - отправляет WEATHER_PLACE,
common/WeatherForeca.php - принимает настройку
Config.php новая настройка WEATHER_PLACE 


1.00221 04/08/21
1) logo.png добавил версию, для отмены кэша
2) картинка больше
3) title Bereg


1.00222
1) Цена для водителя добавить в объект


1.00223 13/10/21
1) EditPeriodShift.js, EditPeriodDateShift.js контроль для определенных ролей периода
серверная константа role_view_restriction
На сервере изменения в моделях OrderList ShipmentList контроль периода
2) Блокировка входа с новых устройств


1.00224 14/10
1)functions/AppBeton.js
	SessionVarManager.prototype.get async, возможность запуска без callBack
2) Destination_Model.php::insert() перекрытый метод не соответствует родителю
3) Destination_Controller.php add_coord_model($inf) $inf не содержит полей - notice
4) User_Controller.php пустые устройства с автоавторизации (звонки, весы и т.д.) баннятся сразу
5) App.prototype.subscribeToEventSrv принятие событий для изменения ServerVar
6) Изменение значения ServVar для всех SessionVarManager.php App.js подписка, наименование события md5(ServVar.update.ID)
	RoleRestriction_Controller.php


1.00225 29/10/21
http://localhost/beton_new/index.php?c=Shipment_Controller&f=shipment_ttn&v=ViewXML&id=135102
1) Печать ТТН/путовего листа из шаблонов Excel
- ExcelTemplate_Controller
Редактирование шаблонов, добавление файла, параметров
Новые реквизиты в водителях, автомобилях, клиентах, владельцах
Vehicle_Controller
Driver_Controller
ttn.sql
vehicles_dialog.sql
banks_list/banks - новая схема banks из ms
Shipment_Controller новый метод печати ТТН + путевой лист
- Кнопки печати в командую панель отгрузки
- Автообновление банков


1.00226 30/10/21
1) Map_View.js, Map_View.prototype.refreshCurPosition если this.m_curVehicleId==undefined, отправляла запрос на одно авто и приходила ошибка
permission denied т.к. null авто у владельца нет

1.00227
1) RawMaterialConsRateDateList_View новая команда: ввести на основании
raw_material_cons_rate_dates новое поле base_id
raw_material_cons_rate_dates_process.sql Учет нового поля
Собственно реализация команды
RawMaterialConsRateInsOnBaseBtn.js
RawMaterialConsRateDateGridCmdInsOnBase.js


1.00228 03/02
1) X RawMaterialConsRateDateList_View колонка dt DateTime
table raw_material_cons_rate_dates field dt - DateTime 
ALTER TABLE raw_material_cons_rates ALTER COLUMN dt SET TYPE timestamp without time zone
установить все время на 06:00 - начало смены
update raw_material_cons_rate_dates SET dt+'06:00'::interval
X function raw_material_cons_rate_dates_ref descr
X view raw_material_cons_rates_dates_list
X  functio raw_material_cons_rates()
function recalc_consumption()

2) Periodic values: water_ship_cost,demurrage_cost_per_hour - constants,
destination_price,destination_price_for_driver
Graph_Controller - формирование графика по завкам. усреднил с одинаковым временем
Destination_Controller complete_for_order - цены
shipments_for_veh_owner_list
shipments_list
destination_list_view

1.00229
1) Destination_Controller price for complete
2) PeriodValue_Controller method get_last_val(), ButtonEditPeriodValues - EditControl value update after editting history


1.00230
1) Если удалить цену, то невозможно закрыть историю цен из-за попытки обновления ButtonEditPeriodValues
2) Подборы дата, победил форматирование, обновление платформы
3) Новое поле у поставщика: уведомление о заказне bool defaul FALSE SupplierDialog_View
4) User_Controller email is not required
Проврить установку обновлений таблиц!

1.00231
1) Частичные даты
2) VehicleDialog количество спутников
3) ClientTelList, ClientList, UserList - отметка если ли телеграмм
4) Выбор короткого адреса!! Тугулым, Мыс
5) При смене даты заявки надо перестративать график старой даты!!!
6) Форма отправки сообщений: пользователь/контакт/контрагент, сообщение
7) Сообщение со ссылкой на телеграмм
8) Перделать регистрацию через телеграм
9) Контакт в заявке, отобразить является ли пользователем телеграмм, предложение отправить сообщение
10) Входящий звонок, отобразить является ли пользователем телеграмм, предложение отправить сообщение


1.00238
1) новые константы: chart_step_quant,chart_max_quant. PlantLoadGraphControl.js
2) PumpVehicle новое поле specialist_inform
	Order_Controller.php
3) ClientTelEdit.js фильтр при открытии окна
4) Chat_View.js
5) Смена контакта из звонка

1.00240
Авторизация Telegram
КРОМЕ!!! AstCall_Controller


1.00241
1) Авторизация Telegram через код
2) Макс погрешность от req_quant
3) Поправил путевой лист: водители, класс ВУ. Исправлена ошибка при печати.


1.00242
1) Vehicle->make length increased
2) ProductionMaterialList_View.js


1.00243
1) VehicleDialog_View->make
2) Соответствие пользователей. Облагородил форму
3) Только авторизация телеграм

1.00244 03/06/22
1) Авторизация Телеграм, телефон всегда доступен
2) Мелкие исправоения: RawMaterialMapToProductionList_View

1.00245
1) EditRef.prototype.resetKeys null + удаление

2)
	Constants.php version
	ControllerDb.php
	GridAjx.js addLsnToReadPublicMethod()

3) TMUser_Controller.php
update() Adds dataType param to json value

Активация нового завода
4) Исправлен шаблон: CementSiloForOrderList_View.html col-4
5) Исправлен шаблон: MaterialStoreForOrderList_View.html col-4
6) AssignedVehicleList_View.js PROD_SITE_COUNT=3, AssignedVehicleList_View.html  AssignedVehicleGrid.js


1.00246 26/09/22
1) AssignedVehicleList_View.prototype.setData не работало обновление данных по третьему заводу




1) SessionVarManager.php new method getEmitterId() fromcookie!!!
2) New eventfor php servers. SessionVar.setEmitterId App.js 
3) ControllerDB.php emitter from cookie!!!



1.00248 30/01/23
1) Contact_Controller


1.00249 31/01/23
1)doc_material_procurements_process
material_id=1240 Обнуление количества!!!


1.00251 01/02/23
1) DOCMaterialProcurementList_View полноценная форма для отдельного просмотра
2) Убрал из формы лаборанта Lab30
3) Изменение Геозоны: не запиывает при смене ТОЛЬКО координат! DestinationDialog
4) DriverEdit данные из модели DriverList_Model


1.00252 02/02
1) TmOutMessage_Controller не был реализован методе tm_invite_contact(contact_id)
2) PumpVehicleDialog_View CommandBinding при добавлении контрола с типом JSON обязатнельна привязка к полю,
	привязка по-умолчанию с тем же именем не канает!!!


1.00253
1) Telegram
2) ConcreteType +official_name


1.00255 09/02/22
1) Графики лаборанта



1.00256
1) Второй график лаборанта: возможность отключения значений. LabChart2Rep_View
2) LoginTM.js, User_Controller
3) RawMaterialPriceForNormList_View нет сортировки
4) Переделал material_avg_consumption_on_ctp теперь нормы берутся непосредственно из таблицы норм, а не из регистра, без подтягивания отгрузок
Добавил колнки для подбора Elkon
RepMaterialAvgConsumptionOnCtp.html.xsl


1.00257
1) Мелкие косяки по весовщику: разные ошибки не нашли талон, уже погашен
2) контроль перед формированием графиков если не выбраны параметры



1.00258
1) RepMaterialAvgConsumptionOnCtp_View.prototype.onGetReportData неверный ид таблицы для печати
2) Общее поступлени за период (не податам!)


1.00259 03/05/2023
1) Отгрузки насосы. Поиск по насосу


1.00260 11/05/2023
1) Спецификации/договоры


1.00261 12/05/2023
1) Копирование при inline editting GridAjx.js initEdit
2) Ошибки в форме звонка


1.00263 29/05/2023
1) Выбор роли, если к пользователю привязано два контакта
User_Controller, ViewBase.html.xsl, ViewBase.php (allowed_roles), 



1.00264 07/06/23
1) OrderMakeList.html все переделано поддинамические производственные площадки
2) set_vehicle_schedule_free(), geo_zone_check() при освобождении отмечается текущая зона
functions/VehiclRoute::getZoneListQuery($vehicleId)
Как-то сделать, чтобы возвращадись все возможны зоны производства, а не одна, и маршруты от них



1.00266
1) Operator, нормально силоса. Только один завод
2) Свертка панелей
3) Отчет по движению на 2 разных prodBase


1.00267 13/06
1) Отчет эффективность, VehicleOwnerEdit
2) Состояие авто + инфа по базе




1.00268 21/06/23
1) raw_material_cons_rate_dates + production_site_id
2) Эффективность - переделана функция SLQ, вызов, теперь передается ИД владельца, отображение владельцев
3) Сохранение состояния отключения панелей
4) gen() расписания - POST запрос, вместо GET 
5) Фильтрация повладельцу в Список ТС, Отгрузки для владельца
6) raw_material_cons_rates Добавлензавод. Подборы позаводу.
set_vehicle_busy Исполняет разны запросы от даты. Либо постарому буз завода, либо по новому с заводом


1.00269 23/06
Цены по зонам в зависимости отбазы с датой
destination_prod_base_prices_list.sql
destination_prod_base_price_val.sql
destination_prod_base_driver_prices_list.sql
destination_prod_base_driver_price_val.sql
destination_list_view.sql
shipments_list.sql
shipments_cost.sql
shipments_for_veh_owner_list.sql



1.00270 10/07/23
1) График работ VehicleScheduleEdit_View.js



1.00272 14/07/23
1) VehicleScheduleEdit_View.js для владельцев. Подправил серверную часть. CSS
2) Отчет Итоги с выбором владельца



1.00273, 1.00274 14/07/23
1) Отображение текущих назначений:
	AssignedVehicleList_View.js тепрь использует локальный шаблон только для вывода изформы заявок, там ЖЕСТКО забито на 4 завода, по 2 в строке
	При выводе на телевизориспользуется серверный шаблон, там отображается ТОЛЬКО первая производственная  база!!!

2) Смена - сошел, потом все равно превращает в состояние свободен. Не нашел такого



1.00275
1) Панели двигаются, осталось только визуально отображать движение.
OrderMakeForLabList
OrderMakeForWeighingList
OrderMake
переделаны шаблоны, формы js, общая функция в App
2) VehicleSchedule_Controller->get_vehicle_owner_schedule теперь + возвращает модель, в которой включены Авто, которых вообще нет в расписании
VehicleScheduleEdit_View теперь учитывает такие автои добавляет их в таблицу



1.00276 08/08/23
1) Order_Controller.php теперь не зависит от производств, все динамически
2) RawMaterial_Controller.php теперь не зависит от производств, все динамически, вызывается функция из Order_Controller::add_production_bases($link)
3) единая sql функция material_actions_prod_base.sql с параметром по ИД производственной базы
4) Shipment_Controller.php теперь не зависит от производств, все динамически, вызывается функция из Order_Controller::add_production_bases($link)
5) OrderMakeList.html шаблон в контейнер подвижных панелей добавлено свойство style="position:static" для видимости при перетаскивании
6) ВНИМАНИЕ! В шаблоне OperatorList.html осталась зависимость (жестко забито на 3 завода!!!)
7) ВНИМАНИЕ! В шаблоне отчета RepMaterialAction.html.xsl также жесткая привязка!!!
8) ВНИМАНИЕ! В шаблоне AssignedVehicleList.html  также жесткая привязка!!! Только заводы Утяшево
AssignedVehicleList_View опасное ограничение пономеру месту производства (4 - Утяшево)
9) Локальный шаблон AssignedVehicleAllBasesList_View.html жесткая привязка Это главный экран


1.00277
1) Shipment_Controller для оператора имя моделей также как для всех с ИД производства, но показывает однопроизводство
Также исправил OperatorList.html серверный шаблон. Привел в соответствие название моделей
2) ГЛОБАЛЬНОЕ ИСПРАВЛЕНИЕ! GridCellDetailToggle.js templateId=" ", чтобы не брал серверный шаблон



1.00278 11/08/23
1) Выбор базы при ручном освобождении ТС
	- Новая фукнция set_vehicle_schedule_free.sql Теперь принимает 2 аргумета. + prod_base_id
	- VehicleScheduleGridCmdSetFree.js
	- VehicleSchedule_Controller.set_free() 2 аргумента
2) Возможность замены базы при Свободен/назначен
	- VehicleScheduleMakeOrderGrid.js
	- VehicleSchedule_Controller.set_production_base()
	- vehicle_last_states.sql, vehicle_states_all Новые поля: имя объека для вывода в грид,  имя производства для сортировки
	- VehicleScheduleMakeOrderList Новые поля




1.00279
1) База в редактировании графика.
	- VehicleSchedule_Controller->get_vehicle_owner_schedule(). Изменена модель, + база первого статуса.
	- VehicleScheduleEdit_View.html измен локальный шаблон
	- VehicleScheduleEdit.html измен серверный шаблон
2) Печатная форма графика.
	- Скрипт get_schedule_for_all Добавлено поле с базой
	- VehicleScheduleReportAll.html.xsl Добавлеа база



1.00280 16/08/23
1) Возможность редктирования таблицы заявок для лаборанта
	- OrderMakeForLabList_View.js 
	- OrderMakeForLabDialog_View новое вью
	- OrderMakeGrid.js CommonHelper.merge(editViewClass)
2) Пересчет норм расхода.
	- RawMaterialConsRateDate_Controller() + param production_site_id, CALL recalc_consumption(%d, %d)
	- recalc_consumption.sql turned to PROCEDURE with COMMIT inside
	- RawMaterialConsRateCalcBtn add production_site_id parameter
3) Итоговой отчет по ТС
	- VehicleOwner_Controller->get_tot_income_report()
	- VehicleOwnerTotIncomeRep_View.js
	- VehicleOwnerTotIncomeRep_View.html local template
	- css style



1.00281
1) Весовая программа
бтнОбмен.ПриЗаписиВзвешивания()
",""sender_name"":"""+?(Ссылка.ПунктОтправления.Пустая(),"",бтнПодготовитьСтрокуДляJSON(Ссылка.ПунктОтправления.Наименование))+""""+
	RawMaterial_Controller.php изменил load_procurement	
2) Shipment_Controller.php убрал косяк 1088
3) Список операторов. Телефон убрать из контакта.




1.00282
1) Автозаполнение полей в поступлении материалов
	DOCMaterialProcurementDialog_View
	DOCMaterialProcurement_Controller.php   исправил ошибки
	
	
	
	
1.00284 24/08/23
1) В форме оператора отобразить полный ГосНомер ТС
	- OperatorList_View.js
2) Сопоставление ТС в Элкон и в Бетоне: если есть буквы - поиск точный, нет - только по цифрам
	- material_fact_consumptions_find_vehicle.sql




1.00285 30/08/23
1) Печать накладной отгрузки. Гос номер ТС вместо порядкового номера.
	- Shipment_Controller
	- ShipmentInvoice.pdf.xsl
	
2) Ценовые схнмы насосов. Гарантированная сумма
	- shipments_list.sql
	- shipments_pump_cost
	- OrderCalc_View.js recalcUnloadCost()		
3) Убран отступ слева отглавной панели
	- style.css ontent
4) Главный экран, некоторые таблицы вплотную слева
	- Класс для панели wideGridPanelBody OrdeMakeList.html, OrdeMakeForWeighingList.html
	- OrderMakeGrid формт количества и остатка - 1 знак + нет разделителя тысячей
5) Постоянно выскакивает спецификация, мешает постановке заявки
	- ClientSpecificationEdit minLengthForQuery=1
	
6) После 12 часов ночи не обновлят статусы авто
	geo_zone_check.sql	
7) Печать графиков. Можно менять базу
	- VehicleSchedulReportAll.html.xsl
	- VehicleSchedulReportAll.js
	- get_schedule_for_all2.sql
	- css измененный файл: разные цвета для баз, выходной


1.00286
1) При формировании графика можно отбирать авто по свойству
	- VehileSchedule_Controller.php
	- ScheduleGen_View.js
	- ScheduleGen.html
2) Новый блок по заданиям, начало, таблицы, форма
	attachmets, task
3) Информация по обновлениям в программе



1.00306 12/01/24
1) quality_passport_or_last.sql Исправлено
2) сoncrete_types + field prochnost для паспорта, ConcreteTypeList_View.js
3) Автоподстановка полей в паспорте: QualityPassport_Controller, QualityPassportDialog_View.js


1.00307 12/01/24
1) Помежуточный слив, косяк в Order_Controller нет новых полей


1.00308 13/01/24
1) Функция quality_passport_smes_num.sql для определения поля Номер бетонной смеси
2) Листовое представление QualityPassportList, форма QualityPassportList_View - реестр паспартов
3) passport_print.sql, quality_passports_object_or_last.sql приведено в соответствие с новыми полями
4) Добавил поле reg_nomer_dekl в паспорт, +поиск в контроле


1.00309 15/01/24
1) quality_passports krupnost - text, 
quality_passports_list.sql +field num
passport_print.sql
quality_passports_object_or_last.sql


1.00310 19/01/24
1) ClientDebt_Controller->update_from_1c
2) Взаиморасчеты с контрагентами
3) OrderDialog_View.js AstIncomeCall_View.js - взаиморасчеты в звонке
4) ClientDebt_Controller->update_from_1c($pm), functions/regl_client_debts.php ExtProg.php


1.00311 08/02/24
1) Добавление f, w на форму заявок:
	orders_make_list.sql Добавлены колонки: f_val, w_val
	OrderMakeGrid.js
	OrderMakeForLabList_Model, orders_make_for_lab_list.sql
	orders_make_for_lab_period_list.sql


1.00312
1) Отображение  f_val/w_val в списке заявок. Значения есть всегда! даже без паспорта.
	quality_passports +field concrete_type_id, changed index signature
	quality_passports_process.sql
	quality_passports_object_or_last.sql
	orders_make_list.sql, orders_make_for_lab_period_list.sql, orders_make_for_lab_list.sql

2) Новые поля в марках _val, w_val
	ConcreteTypeList_View.js
	orders_make_list.sql, orders_make_for_lab_period_list.sql, orders_make_for_lab_list.sql
3) views/Child.html.xsl

4) PumpVehicleEdit.js + last price schema to description


1.00314 14/02/24
1) RawMaterial_Controller->get_material_actions_by_shift_list new Public method
	- view added
	- RepMaterialActionByShift_View.js
	- RepMaterialActionByShift.xsl template


2) Shipment_Controller->get_passport_file_name() и все функции печати



1.00315 13/03/24 Временный слив для Конкрида
1) Роли для контактов
	1.1) foregn table ext_users add column ext_role_id
	1.2) add_contact.sql set user_role or client
	1.3) Update existing contacts with roles
	1.4) Tm bot added support for media files.
		insert into shipment_medias if a driver through callback
		functions/bot/index.php
		
	1.5) shipment_medias add trigger before insert
	1.6) Функция notifications.chat()
	Отобразить в чате ссылку на файл, если фото - привью
	Возможность открыть - модальное окно:
		фото - полный экран, загрузка большого фото
		Голос - Аудио плеер
		Видео - видео плеер

	TODO: Notification_View add possibility to send files: pictures, audio etc. Drag && drop
		Chat_View messages

1.00318 18/03/24 
1) DestinationDialog_View.js константа вместо забитого жестко значения
слив промежуточной работы


1.00320
For Javascript

1.00321
TmChat_View.js corrected beep in messages.

1.00322 2024-04-12
UserChat_Controller->send() validation
functions/notifications.php send to TM validation

ExcelTemplate_Controller template cache mechanism.
AppBeton.js sendNotification() function, id= body is necessary for modal dialogs with templates. 
TmNotification_View.js added parameter

1.00323
1) sms_type added new type: order_for_pump_ship
added new sql function sms_pump_order_ship_f.sql
2) Shipment_Controller->sendShipSMS() added notification to pump driver if there is a pump in order



1.00324
1) Notification on shipment to pump vehicle driver, send to drivers with marking only.
	PumpVehicle added field driver_ship_inform bool
	PumpVehicleList model
	PumpVehicleDialog_View.js
	PumpVehicleDialog.html
	pump_veh_list.sql, pump_vehicles_list.sql
	sms_pump_order_ship_ct.sql


1.00325 
1) OrderMakeForLabDialog_View.js added field for edit: concrete_type
	Order_Controller->update() added clearing client_specification_id when concrete_type_id is changed.
		!!! if pay_cash is set then error is issued. Recalc is needed.
	Order_Controller->get_object_for_lab() added field concrete_types_ref,
	metadata.xml model OrderMakeForLabDialog_Model added concrete_types_ref field. 
2) VehicleScheduleMakeOrderGrid added new command - show vehicle dialog. VehicleScheduleGridCmdShowVehicle
3) TmUserPhotoList_View.js corrected tooltip behaviour
4) When user role is vehicle_owner Chat methods are called after login, not allowed, but called. ViewBase.html
5) How to constraint queries if a user manually removes filter in gui? Shipment_Controller->get_list() add date_time filter on one shift.
add conception of ObligatoryFilter like global, but is applied only if no filter on this column.
6) User_Controller added filter support for "mild" filters, applied only when there is no filter at all. ModelSQL.php, GlobalFilter.php


1.00325 
1) RawMaterialTicket added new field quarry_id of type quarries.
	RawMaterialTicketList, RawMaterialTicketCarrierAggList
	raw_material_tickets_list.sql
	raw_material_ticket_carrier_agg_list.sql
	RawMaterialTicketList_View.js
	RawMaterialTicketIssueBtn.js
	RawMaterialTicket_Controller->generate() function changed.
	RawMaterialTicketClose_View.js


1.00326 
1) Change column order in RawMaterialTicketList_View.js, RawMaterialTicketClose_View.js


1.00329 
1) Work reliably from slave server. ControllerDb return correct lsn position.
	Graph_Controller changed function sendEvent(), added lsn position
	OrderMakeList_View.js 
	OrderMakeForLabList_View.js
	OrderMakeForWeighingList_View.js
	   changed functions: srvEventsCallBack(), runSpecificUpdateMethod()
2) User_Controller changed mild filter not to have expression
3) VehicleScheduleGrid, sometimes do not show vehicle information, issues a query, but no hover. 
4) ms with haProxy


1.00330 04/06/2024
1) User_Controller.php: user roles vehicle_owner && client removed mild filters. They should be merged,but are not. Mild filters override personnal which is incorrect.
2) Shimpent_Controlle.php removed notifications for pump owners and drivers on every shipment.
3) Client_Controller->insert_from_order() corrected insert to readOnly server
4) VehicleRoute->getRoue() dbLink should be from master server. Vehicle_Controller->get_current_position() 
5) User_Controller mild filters: AstCall changed filter field from end_date to start_date to match with list filter.
6) DOCMaterialProcurement_Controller added new dialog model DOCMaterialProcurementDialog. There is a problem with mild
	filters as they are applied to dialog model.
	DOCMaterialProcurementDialog_View.js corrected to use new model.



1.00331 2024-06-07
1) Make new table for deleted orders. In "on delete" trigger put information into that table. New List
	- OrderGarbage_Model added new model.
	- OrderGarbageList_Model, OrderGarbageList_View.js new Javascript model.
	- OrderGarbageDialog_Model, OrderGarbageDialog_View.js Javascript dialog forms.
	- Order_Controller->delete() copy to garbage table + delete in transaction + event for OrderGarbage.insert. Changed controller behaviour.
	- new sql functions: order_garbage_num(), order_garbage_ref() 

2) Report for vehicle owner: but same report but for all vehicles.
	- VehicleOwnerTotRepAll_View.js added new file.
	- VehicleOwner_Controller->get_tot_income_report_all() added new public method.

3) PeriodValueList_View.js added default sorting by date_time DESC


1.00332 2024-06-10
1) VehicleScheduleMakeOrderGrid.js field state added production base description.
	vehicle_states_all.sql different approach to retrieve production base when shift state.


1.00333 2024-06-11
1) Contact_Controller->upsert() read-only server.


1.00334 2024-06-14
1) SessionVarManager added key array to hold all keys even with undefined values. Otherwise two queries were issued. 



1.00335 2024-06-19
1) app_srv: Event on shipment 
2) ClientList_View.js removed default sorting. Query is too slow with ORDER BY + LIMIT
3) RepMaterialAction_View.js, RawMaterial_Controller->get_material_actions_list()
	- new filter production_base_id
	- make filter always visible;
	- make current shift a default period


1.00335 2024-06-28
1) functions/bot/index.php Tm callback: in case of the auth message do not send "TmOutMessage.sent" event.
2) VehicleOwnerTotIncomeAllRep.xsl added vehicle items. Report is ready without vehicle details.
	VehicleOwner_Controller->get_tot_income_report_all()
3) ViewBase.himl.xsl chat reinitialized on page update when menu item is changed.
4) OrderCalc_View.setPayCash() warning if gui total sum does not match saved sum.


1.00336 2024-07-05
1) EventServer: delete event does not work. Corrected Order_Controller
3) RawMaterialTicketDialog new model for object edit.
4) RawMaterialTicket allow edit for weighing interface. RawMaterialTickerList_View.js
5) Period check for list models: Order_Controller, OrderGarbage_Controller, Shipment_Controller, DOCMaterialProcurement_Controller, MaterialFactConsumptionCorrectionc_Controller

1.00337 2024-07-30
1) New model to hold silo materials: SiloMaterial
2) Correct balance on the front page
3) Shipment_Controller->get_list_for_order() no date check!
4) ExcelTemplate_Controller error when converting to pdf.
5) Silo sorting by elkon name. cement_silos_for_order_list.sql, cement_silos_list.sql
6) DOCMaterialProcurement_Controller->get_list() when filters are set returns bad file and v=ViewExcel
	ControllerObjServer.download(): params to string with ServConnector.queryParamsAsString()
7) material_actions_prod_base1, material_actions_prod_base2, material_actions_prod_base3 sorting by production_sites.name+silo.production_descr



1.00338 08.09.24
1) OrderMakeList_Model. If filtered with client, set date results to error: client_id attribute not found for model OrderMakeList_Model.
also added destination_id, user_id
changed order_makes_list.sql and OrderMakeList_Model
2) AssignedVehicleList adjustments:
	- tmpl/AssignedVehicleList.html
	- js/AssignedVehicleList_View.js added new template param


1.00339
1) Reports:
	Shipment_Controller->get_pump_list(),
	Shipment_Controller->get_list_for_client() error: period not set.
Поставил сразу, заменив Shipment_Controller.php, User_Controller.php
2) ShipmentForClientList_View.js destination filter shows enum, not DestionationEdit
	different classes for ext users and Beton users: DestinationEdit, DestinationForClientEdit
3) DOCMaterialProcurementList_View add column after Vehicle, ПунктОтправления

- Silo Model which returns additional info:
	producing bool, vehicle under production (plate)
	Events: prodiction start(with vehicle), production end (already exists)

+ shift + base name
+ Chat: click does not work sometimes on child windows.
+ Main window: unnecessary query SessionVar->get_values("role_view_restrictions") - two times!!!
+ ViewBase.php line 2143, andefined array key HTTP_HOST
Tasks:
	2) Report for vehicle owner: make the same report but for all owners/vehicles.
	3) Check contact transfer on call to a new client. Old client must be deprived from this contact.
basic_classes/ViewExport.php line 103, DOMDocument->loadXML(), namespace prefix xsi for nil on descr is not 
defined in Entity line 1.


1.00340 18-09-2024
1) Detail table in all rows of the parent table GridCellDetailToggle.js, OperatorList_View.js
2) PupmVehicle new columns: min_order_quant, min_order_time_interval
		pump_veh_list.sql
		pump_veh_work_list.sql
		PumpVehicle_Controller.php: methods insert/update added checkings before write.
		PumpVehicleDialog_View.js
		PumpVehicleList_View.js corrected some fileds, centered.
		OrderDialog_View.js added properties: m_onChangedDate, m_onChangedTime



1.00341
1) ShipmentForOrderList_View.js added editReadPublicMethod, as there is a custom readPublicMethod
2) Erorr in Order_Controller->check_pump_vehicle_min_val()


1.00342
1) Erorr in Order_Controller->check_pump_vehicle_min_val()


1.00342
1) DOCMaterialProcurementList_View column with total is misplaced by 1 to the left.
2) ControllerSQL.php =ANY() filter
3) Search in contact field: pump_vehicles, users, clients, suppliers

1.00343
1) Сумма документа пересчитана, запишите OrderCalc_View.setPayCash()
[object Object] в контакте

1.00344
1) Error in Supplier type field contact_ids "Tex"


1.00345 2024-10-04
1) User_Controller->do_login() if logged with name/password there is no Telegram photo
2) Make default filters for: PumpVehicleList, UserList, EmployeeList
3) MakeOrderGrid.js totals shifted to the left colSpan set to 5 instead of 3
4) On deleting shipment, delete first quality passport if exists.
	set_vehicle_free()
5) css files: there are no digits after ? sign.
	ModelStyleSheet.php added midified parameter.


1.00346 2024-10-11
1) TTN, PutList
	ExcelTemplate_Controller->downloadFilledTemplate() corrected error.
2) ShipmentDocRep_View.js
	New model ShipmentForDocList_Model
	New view


1.00347
1) Incoming messages from Telegram with auth codes come to every user.
	functions/bot/index.php
	Query code text condition is incorrect.


1.00348
1) ProductionSiteForEditList_View.js: no data when edit.
	Added field vs_state to ShipmentDialog_Model
	ProductionSite->get_object method points to model ProductionSiteForEditList_Model
	No editReadPublicMethod!!! in ProductionSiteForEditList_View and ShipmentForOrderList
2) Order_Controller->send_messages() concrete_types official_name instead of name.




Если открыта детальная модель на редактирование и при приходит основная модель, то она перересовывается и уходит фокус с детальной модели
XXX Удаленные элементы справочника: фильтр вверху, пометка спереди, по возможности у всех справочиников. Example: PumpVehicle
Движение на базу - контроль всех баз. Поиск ближайшей, смена
Отобразить, если остлось Х км до базы какой-то знак
VehiceRoute::getZoneListQuery()
Vehice_Controller->get_current_position()  возвращает одну зону в модели ZoneList_Model поле base_zone
Map_View.js Map_View.prototype.addZones(model)




КРОМЕ!!! AstCall_Controller
!!!productions_get_mat_tolerance_violated!!


ЧТо НАДО
+ 1) Автообновление данных OSRM хотя бы раз в месяц (?)

- Новая программа CallAgent webSocket, https

- Установка заявок по кнопке в Elkon

+ Autoreload SrvConf on publish, script.php to send ws event. Event Service.reload_config

+ Новая программа весы, установка соезинения https

+ Список активных с ФИО - геперссылка для карточки, по датам!. UserChat

- Возможность скрыть/показать колонки


************************
-3)Мониторинг ошибок связи:
	1) оператор - отображать ошибки в окне ошибок
	2) Сообщение по СМС, если нет привязки к производствам (раз в стуки) или по-другому


Что надо сделать:
!! Vehicle->get_track если возвращает пустой набор (нет маршрута) в ГУИ надо показывать карты с заводом и объект! а не пустую карту!

3) Возможность следить за авто он-лайн, пока авто едет до клиента. Ссылка в СМС (в последеней)
!!! 

При формировании трэка если расстояние между точками больше N км (+ и время не более N минут), то достраивать маршрут через OSRM,
а  не соединять линию по полям

Если маршрута нет показать базу и объект, а не пустую карту!
При показе поеледнего маршрута (по тек. время) показывать и авто тоже!

Перенос накладных в бухгалтерию
Передвигаемое окно звонка и не модальное


